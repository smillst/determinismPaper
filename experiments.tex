\section{Evaluation}
\begin{itemize}
    \item goals of evaluation: Compare with NonDex and Deflaker
    \item Quantitative comparison: \TheDeterminismChecker finds all bugs reported by NonDex and Deflaker?
    \item Qualitative study of the issues discovered.
    \item System info: 2.3 GHz Intel Core i5, 8 GB 2133 MHz
\end{itemize}

\subsection{Running NONDEX on Randoop}
To evaluate how existing tools perform on large programs, we ran the tool \href{https://github.com/TestingResearchIllinois/NonDex}{NONDEX~\cite{nondex}} on 
\href{https://github.com/randoop/randoop}{Randoop~\cite{randoop}}.
We followed the instructions to build the project with the gradle plugin. 
NONDEX terminated without reporting any flaky tests.
\todo{check if the bugs discovered by \TheDeterminismChecker have test coverage}
\todo{We investigated the tests covering code that \TheDeterminismChecker reported as nondeterministic.
If code is covered by tests, NONDEX couldn't discover it. Else, its a limitation of NONDEX}.
This indicates that the additional programmer effort required by \TheDeterminismChecker is justified
as our tool discovers non-trivial issues and doesn't depend on code coverage or other runtime heuristics.

\subsection{NONDEX case study}
\cite{nondex} reported flaky tests on 21 open source projects. The authors also reported the sources of flakiness
after manually inspecting these tests. We ran \TheDeterminismChecker on all these benchmarks with the objective
of measuring recall of our tool. We cloned all 21 repos and switched to the commit that had a flakiness issue as reported 
in~\cite{nondex}. Of these projects \<handlebars> has a compile time failure which prevents us from running \TheDeterminismChecker on it. For benchmarks \<visualee>, \<easy-batch>, and \<vraptor>, we couldn't find
the sources of flakiness as reported in~\cite{nondex} anywhere in the respective repositories.
\TheDeterminismChecker reported the nondeterministic locations correctly in the rest of the projects.
All these benchmarks and instructions to reproduce our results can be found at \href{https://github.com/t-rasmud/determinismCaseStudies}{https://github.com/t-rasmud/determinismCaseStudies}.
\todo{P4, P12 and P21 det checker isn't recognized?}

Discussion of results:

\begin{itemize}
    \item Look at the source method under test.
    \item annotate the local arrays and collections (This has been mostly sufficient for recall)
    \item Refer to table and describe it.
    \item P7: same source causing multiple tests to be flaky
    \item Example for class.GetDeclaredMethod() and show annotations
    \item Example for HashMap.entrySet() and show annotations.
    \item qualitative comparison: orthogonal techniques (reporting tests vs reporting source locations).
    \item From NonDex paper: "manually inspecting these failures was rather challenging"
    \item P18 sl4j: nondeterminism in the test case. we provide stub for junit.
    \item Specification for Assert: parameters are annotated as Det
    \item \todo{Link to det checker repo?}
\end{itemize}

\begin{table}[]
    \begin{tabular}{|p{1.5cm}|p{1cm}|p{4cm}|p{5cm}|}
        \hline
        Benchmark & Recall? & Error message source & Error msg  \\ \hline
        P1 & Yes & FieldAccess.java: [102,87] & assignment type incompatible \\
        P2 & Yes & YamlWriter.java: [224,28] & cast unsafe  \\
        P3 & Yes & DateTimeZone.java: [731,27] &  return type incompatible \\ 
        P4 & * & Det checker not found  &   \\ 
        P5 & ** & Class.getDeclaredMethods not found &    \\ 
        P6 & Yes & OptionGroup.java: [55,40]  & argument type incompatible \\ 
        P6 & Yes & Option.java: [157,28]  &  assignment type incompatible\\
        P7(test error) & Yes* & checker/ tests/ determinism/P71.java: 5 & return type incompatible \\ 
        P7(2) & Yes & FieldUtils.java: [219,84] & assignment type incompatible \\
        P7(2) & Yes & Reflection ToStringBuilder.java: [543,65]  & assignment type incompatible  \\
        P7(2) & Yes & HashCodeBuilder.java: [193,69]  & assignment type incompatible   \\
        P7(2) & Yes & CompareToBuilder.java: [322,65] & assignment type incompatible   \\
        P7(2) & Yes & EqualsBuilder.java: [419,69]  & assignment type incompatible  \\
        P7 & Yes & FieldUtils.java: [200,69] & assignment type incompatible \\
        P7 & Yes & FieldUtils.java: [219,84] & assignment type incompatible  \\
        P7 & Yes & FieldUtils.java: [240,86] & assignment type incompatible  \\
        P8 & ** & getDeclaredFields not found &   \\
        P9 & Yes & Printers.java: [269,97]  &  enhancedfor type incompatible \\
        P10 & ** & getDeclaredFields not found  &  \\
        P11 & Yes & MapUtils.java: [20,50]   & enhancedfor type incompatible  \\
        P12 & *  & 0 errors &  \\
        P13 & ** & unbuildable handlebars &  \\
        P14 & Yes  & Maps.java: [91,69] & invalid element type   \\
        P15 & Yes & PkiMessageDecoder.java: [144,29]  &  enhancedfor type incompatible  \\
        P16 & Yes & MethodSorter.java: [56,61]  & assignment type incompatible  \\
        P17 & Yes & JSONObject.java: [674,51]  & assignment type incompatible  \\
        P18 & Yes & SubstitutableLoggerTest.java: [67,61]   & enhancedfor type incompatible  \\
        P19 & Yes & DataDictionaryEventSource.java: [73,78]  &  enhancedfor type incompatible  \\
        P20 & Yes & SaverImpl.java: [43,69]  &  return type incompatible  \\
        P21 & * & 0 errors &   \\ \hline
    \end{tabular}
\end{table}
